<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack-ä»é…ç½®åˆ°æºç  | ğŸ¤¯ç¤¾é•¿ã®ç¤¾ç•œ</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="
init package.json
npm init -yï¼ˆ-yæ˜¯é»˜è®¤éƒ½é€‰yesçš„æ„æ€ï¼‰

scripts
é€šè¿‡npm run buildè¿è¡Œæ„å»ºçš„åŸç†æ˜¯ï¼šæ¨¡å—å±€éƒ¨å®‰è£…ä¼šåœ¨./node_modules/.binç›®å½•åˆ›å»ºè½¯è¿æ¥ï¼Œpackage.jsonå¯ä»¥è¯»å–åˆ°.binç›®å½•ä¸‹çš„è¿™äº›å‘½ä»¤ã€‚å½“npm run scriptsçš„æ—¶å€™ï¼Œä¼šå».binç›®å½•ä¸‹å¯»æ‰¾å¯¹åº”çš„å‘½ä»¤ã€‚
// é…ç½® ...">
    <link rel="preload" href="/assets/css/0.styles.fda92607.css" as="style"><link rel="preload" href="/assets/js/app.7f4b4882.js" as="script"><link rel="preload" href="/assets/js/8.4ab95c53.js" as="script"><link rel="preload" href="/assets/js/3.fadb76cf.js" as="script"><link rel="preload" href="/assets/js/36.66106bb5.js" as="script"><link rel="prefetch" href="/assets/js/10.b2dc55ce.js"><link rel="prefetch" href="/assets/js/11.3a9e0bd4.js"><link rel="prefetch" href="/assets/js/12.7d472947.js"><link rel="prefetch" href="/assets/js/13.aa16d6c6.js"><link rel="prefetch" href="/assets/js/14.37208588.js"><link rel="prefetch" href="/assets/js/15.259fb6c8.js"><link rel="prefetch" href="/assets/js/16.6f1ef36b.js"><link rel="prefetch" href="/assets/js/17.5af21d96.js"><link rel="prefetch" href="/assets/js/18.6b7bd99c.js"><link rel="prefetch" href="/assets/js/19.c826f71e.js"><link rel="prefetch" href="/assets/js/20.d22504b7.js"><link rel="prefetch" href="/assets/js/21.55d5ab5c.js"><link rel="prefetch" href="/assets/js/22.a753f0b7.js"><link rel="prefetch" href="/assets/js/23.699657ef.js"><link rel="prefetch" href="/assets/js/24.b4c49572.js"><link rel="prefetch" href="/assets/js/25.3e4f7af1.js"><link rel="prefetch" href="/assets/js/26.1673bdbd.js"><link rel="prefetch" href="/assets/js/27.f2e3a149.js"><link rel="prefetch" href="/assets/js/28.683f14bc.js"><link rel="prefetch" href="/assets/js/29.e9f41ef1.js"><link rel="prefetch" href="/assets/js/30.1ad33a67.js"><link rel="prefetch" href="/assets/js/31.658218fc.js"><link rel="prefetch" href="/assets/js/32.2894414b.js"><link rel="prefetch" href="/assets/js/33.0ec3aa48.js"><link rel="prefetch" href="/assets/js/34.ed8c5abe.js"><link rel="prefetch" href="/assets/js/35.71e0d56d.js"><link rel="prefetch" href="/assets/js/4.3792b2f6.js"><link rel="prefetch" href="/assets/js/5.57997a9e.js"><link rel="prefetch" href="/assets/js/6.2f06e37f.js"><link rel="prefetch" href="/assets/js/7.dad84601.js"><link rel="prefetch" href="/assets/js/9.929f25d0.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.9c3680bd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fda92607.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">ğŸ¤¯ç¤¾é•¿ã®ç¤¾ç•œ </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">æ–‡ç« </a></li><li class="nav-item"><a href="/tag/" class="nav-link">æ ‡ç­¾</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">ğŸ¤¯ç¤¾é•¿ã®ç¤¾ç•œ </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">æ–‡ç« </a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">æ ‡ç­¾</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">ç¤¾é•¿çš„ç¤¾ç•œ</span> <span itemprop="address"> Â  in åŒ—äº¬</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2020-03-22T00:00:00.000Z">
      Sun Mar 22 2020
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/Webpack" data-v-42ccfcd5><span data-v-42ccfcd5>Webpack</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h1 id="webpack-ä»é…ç½®åˆ°æºç "><a href="#webpack-ä»é…ç½®åˆ°æºç " class="header-anchor">#</a> webpack-ä»é…ç½®åˆ°æºç </h1> <h2 id="init-package-json"><a href="#init-package-json" class="header-anchor">#</a> init package.json</h2> <p>npm init -yï¼ˆ-yæ˜¯é»˜è®¤éƒ½é€‰yesçš„æ„æ€ï¼‰</p> <h2 id="scripts"><a href="#scripts" class="header-anchor">#</a> scripts</h2> <p>é€šè¿‡npm run buildè¿è¡Œæ„å»ºçš„åŸç†æ˜¯ï¼šæ¨¡å—å±€éƒ¨å®‰è£…ä¼šåœ¨./node_modules/.binç›®å½•åˆ›å»ºè½¯è¿æ¥ï¼Œpackage.jsonå¯ä»¥è¯»å–åˆ°.binç›®å½•ä¸‹çš„è¿™äº›å‘½ä»¤ã€‚å½“npm run scriptsçš„æ—¶å€™ï¼Œä¼šå».binç›®å½•ä¸‹å¯»æ‰¾å¯¹åº”çš„å‘½ä»¤ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// é…ç½®ï¼š</span>
<span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>è¿è¡Œ<code>npm run build</code>å°±ç›¸å½“äºè¿è¡Œ<code>./node_modules/.bin/webpack</code></p> <h2 id="plugins"><a href="#plugins" class="header-anchor">#</a> Plugins</h2> <p>æ’ä»¶ç”¨äºbundleæ–‡ä»¶çš„ä¼˜åŒ–ï¼Œèµ„æºç®¡ç†ï¼ˆæ„å»ºä¹‹å‰åˆ é™¤æŸäº›æŒ‡å®šæ–‡ä»¶ä¹‹ç±»çš„ï¼‰å’Œç¯å¢ƒå˜é‡æ³¨å…¥ã€‚ä½œç”¨äºæ•´ä¸ªæ„å»ºè¿‡ç¨‹ã€‚</p> <h2 id="mode"><a href="#mode" class="header-anchor">#</a> Mode</h2> <p>process.env.NODE_ENV</p> <p>production(default), development, none
è®¾ç½®modeå¯ä»¥ä½¿ç”¨webpackå†…ç½®çš„å‡½æ•°ã€‚</p> <h2 id="loader"><a href="#loader" class="header-anchor">#</a> Loader</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token regex">/.css$/</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ³¨æ„ï¼šloaderæ˜¯é“¾å¼è°ƒç”¨çš„ï¼Œæ‰§è¡Œé¡ºåºæ˜¯ä»å³å‘å·¦ã€‚è¿™é‡Œå®é™…æ‰§è¡Œçš„æ—¶å€™å…ˆæ‰§è¡Œcss-loaderï¼Œå†æ‰§è¡Œstyle-loaderã€‚</p> <h2 id="file-loader"><a href="#file-loader" class="header-anchor">#</a> file-loader</h2> <p>å›¾ç‰‡å’Œå­—ä½“çš„æ‰“åŒ…</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token regex">/\.(png|jpg|gif|jpeg)$/</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token string">'file-loader'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token regex">/\.(woff|woff2|eot|ttf|otf)$/</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token string">'file-loader'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å›¾ç‰‡æ‰“åŒ…è¿˜å¯ä»¥ç”¨url-loaderï¼Œå¯¹äºå°å›¾ç‰‡è½¬æˆbase64:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token regex">/\.(png|jpg|gif|jpeg)$/</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">{</span>
    loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      limit<span class="token operator">:</span> <span class="token number">10240</span> <span class="token comment">//å­—èŠ‚ï¼Œ10kb</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å°äº10kbçš„å›¾ç‰‡ï¼Œæ‰“åŒ…æˆbase64ã€‚å‡å°‘ç½‘ç»œè¯·æ±‚ã€‚</p> <h2 id="æ–‡ä»¶ç›‘å¬"><a href="#æ–‡ä»¶ç›‘å¬" class="header-anchor">#</a> æ–‡ä»¶ç›‘å¬</h2> <p>åœ¨å‘ç°æºç å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œè‡ªåŠ¨é‡æ–°æ„å»ºå‡ºæ–°çš„è¾“å‡ºæ–‡ä»¶ã€‚</p> <ul><li>webpackå‘½ä»¤ï¼Œå¸¦ä¸Š--watch</li> <li>åœ¨é…ç½®webpack.config.jsä¸­è®¾ç½®watch: true</li></ul> <h3 id="watchçš„ç¼ºç‚¹"><a href="#watchçš„ç¼ºç‚¹" class="header-anchor">#</a> watchçš„ç¼ºç‚¹:</h3> <ol><li>æ¯æ¬¡ç›‘å¬åˆ°ä»£ç å˜åŒ–åä¼šè‡ªåŠ¨é‡æ–°æ„å»ºï¼Œä½†æ˜¯éœ€è¦æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨ã€‚</li> <li>I/Oï¼Œæ¯æ¬¡æ„å»ºå®Œéƒ½æ”¾åˆ°ç¡¬ç›˜ä¸Šï¼Œé€Ÿåº¦æ…¢ã€‚</li></ol> <h2 id="çƒ­æ›´æ–°-webpack-dev-server-hmr"><a href="#çƒ­æ›´æ–°-webpack-dev-server-hmr" class="header-anchor">#</a> çƒ­æ›´æ–°(webpack-dev-server) HMR</h2> <p>é…åˆHotModuleReplacementPluginï¼Œæ„å»ºåè¾“å‡ºçš„æ–‡ä»¶ç›´æ¥æ”¾åœ¨å†…å­˜é‡Œã€‚
package.json, scripté…ç½®:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --open&quot;</span> <span class="token comment">// --openï¼šæ„å»ºå®Œæˆåè‡ªåŠ¨å¼€å¯æµè§ˆå™¨</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpacké…ç½®ï¼š</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="çƒ­æ›´æ–°åŸç†ï¼š"><a href="#çƒ­æ›´æ–°åŸç†ï¼š" class="header-anchor">#</a> çƒ­æ›´æ–°åŸç†ï¼š</h3> <p>è¿™é‡Œé¢çš„çƒ­æ›´æ–°æœ‰æœ€æ ¸å¿ƒçš„æ˜¯ HMR Server å’Œ HMR runtimeã€‚</p> <p>HMR Server æ˜¯æœåŠ¡ç«¯ï¼Œç”¨æ¥å°†å˜åŒ–çš„ js æ¨¡å—é€šè¿‡ websocket çš„æ¶ˆæ¯é€šçŸ¥ç»™æµè§ˆå™¨ç«¯ã€‚
HMR Runtimeæ˜¯æµè§ˆå™¨ç«¯ï¼Œç”¨äºæ¥å— HMR Server ä¼ é€’çš„æ¨¡å—æ•°æ®ï¼Œæµè§ˆå™¨ç«¯å¯ä»¥çœ‹åˆ° .hot-update.json çš„æ–‡ä»¶è¿‡æ¥ã€‚</p> <p>HotModuleReplacementPluginæ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿ
webpack æ„å»ºå‡ºæ¥çš„ bundle.js æœ¬èº«æ˜¯ä¸å…·å¤‡çƒ­æ›´æ–°çš„èƒ½åŠ›çš„ï¼ŒHotModuleReplacementPlugin çš„ä½œç”¨å°±æ˜¯å°† HMR runtime æ³¨å…¥åˆ° bundle.jsï¼Œä½¿å¾—bundle.jså¯ä»¥å’ŒHMR serverå»ºç«‹websocketçš„é€šä¿¡è¿æ¥ã€‚
ï¿¼</p> <h2 id="æ–‡ä»¶æŒ‡çº¹"><a href="#æ–‡ä»¶æŒ‡çº¹" class="header-anchor">#</a> æ–‡ä»¶æŒ‡çº¹</h2> <p>æ–‡ä»¶æŒ‡çº¹çš„ä½œç”¨æ˜¯ï¼šç‰ˆæœ¬ç®¡ç†ï¼Œåˆ©ç”¨ç¼“å­˜ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// image: hash(md5)</span>
<span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token regex">/\.(png|jpg|gif|jpeg)$/</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">{</span>
    loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">'[name]_[hash:8][ext]'</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// js: `[chunkhash]`</span>
output<span class="token operator">:</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">'[name]_[chunkhash:8].js'</span><span class="token template-punctuation string">`</span></span> <span class="token comment">// å–å…«ä½</span>
<span class="token punctuation">}</span>
<span class="token comment">// css: `[contenthash]`</span>
<span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/\.css$/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// &quot;style-loader&quot;,</span>
    MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
      <span class="token string">&quot;css-loader&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// plugins: [</span>
    <span class="token comment">// æŠŠcssæå–å‡ºæ¥å½¢æˆä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">'[name]_[contenthash:8].css'</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><h2 id="ä»£ç å‹ç¼©"><a href="#ä»£ç å‹ç¼©" class="header-anchor">#</a> ä»£ç å‹ç¼©</h2> <p>jsæ–‡ä»¶çš„å‹ç¼©ï¼šï¼ˆå†…ç½®äº†uglifyjs-webpack-pluginï¼Œé»˜è®¤å‹ç¼©ï¼‰</p> <p>cssæ–‡ä»¶çš„å‹ç¼©ï¼šoptimize-css-assets-webpack-plugin, cssnano</p> <div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
	<span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		assetsNameRegExp<span class="token operator">:</span> <span class="token regex">/\.css$/g</span><span class="token punctuation">,</span>
		cssProcessor<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><p>htmlæ–‡ä»¶çš„å‹ç¼©ï¼šhtml-webpack-plugin, è®¾ç½®å‹ç¼©å‚æ•°ã€‚</p> <h2 id="è‡ªåŠ¨æ¸…ç†æ„å»ºç›®å½•"><a href="#è‡ªåŠ¨æ¸…ç†æ„å»ºç›®å½•" class="header-anchor">#</a> è‡ªåŠ¨æ¸…ç†æ„å»ºç›®å½•</h2> <p>ï¿¼clean-webpack-plugin</p> <h2 id="postcss-loader"><a href="#postcss-loader" class="header-anchor">#</a> postcss-loader</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
     loader<span class="token operator">:</span> <span class="token string">&quot;postcss-loader&quot;</span><span class="token punctuation">,</span>
     options<span class="token operator">:</span> <span class="token punctuation">{</span>
     		<span class="token function-variable function">plugins</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
          		<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          			browsers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'last 2 version'</span><span class="token punctuation">,</span> <span class="token string">'&gt;1%'</span><span class="token punctuation">,</span> <span class="token string">'ios 7'</span><span class="token punctuation">]</span>
          		<span class="token punctuation">}</span><span class="token punctuation">)</span>
      		<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ç§»åŠ¨ç«¯remæ‰“åŒ…é—®é¢˜"><a href="#ç§»åŠ¨ç«¯remæ‰“åŒ…é—®é¢˜" class="header-anchor">#</a> ç§»åŠ¨ç«¯remæ‰“åŒ…é—®é¢˜</h2> <p><a href="https://github.com/amfe/article/issues/17" target="_blank" rel="noopener noreferrer">https://github.com/amfe/article/issues/17<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
ï¿¼</p> <h2 id="èµ„æºå†…è”"><a href="#èµ„æºå†…è”" class="header-anchor">#</a> èµ„æºå†…è”</h2> <p>row-loader, html-inline-css-webpack-plugin</p> <h2 id="source-map"><a href="#source-map" class="header-anchor">#</a> source-map</h2> <p>é…ç½®ï¼š<code>devtool: 'source-map' (|| 'cheap-source-map')</code></p> <h2 id="splitchunks"><a href="#splitchunks" class="header-anchor">#</a> splitchunks</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æå–å…¬å…±æ–‡ä»¶å’Œreactï¼š</span>
optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
  splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
    minSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// æœ€å°çš„ä½“ç§¯é™åˆ¶</span>
    cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
      vendors<span class="token operator">:</span> <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/(react|react-dom)/</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">'vendors'</span><span class="token punctuation">,</span>
        chunks<span class="token operator">:</span> <span class="token string">'all'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      commons<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
        chunks<span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
        minChunks<span class="token operator">:</span> <span class="token number">2</span> <span class="token comment">// å…¬å…±èµ„æºæœ€å°‘å¼•ç”¨çš„æ¬¡æ•°</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="tree-shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰"><a href="#tree-shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰" class="header-anchor">#</a> tree shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰</h2> <p>tree shakingåˆ©ç”¨DCEï¼ˆDead Code Elimination(æ·˜æ±°)ï¼‰æ¥åˆ é™¤æ²¡æœ‰ç”¨çš„ä»£ç ã€‚</p> <ul><li>ä»£ç ä¸ä¼šè¢«æ‰§è¡Œ</li> <li>ä»£ç æ‰§è¡Œçš„ç»“æœä¸ä¼šè¢«ç”¨åˆ°</li> <li>ä»£ç åªä¼šå½±å“æ­»å˜é‡ï¼ˆåªå†™ä¸è¯»ï¼‰</li></ul> <p>å¦å¤–ï¼Œå‡½æ•°ä¸èƒ½æœ‰å‰¯ä½œç”¨ï¼š</p> <p>å‰¯ä½œç”¨è¿™ä¸ªæ¦‚å¿µæ¥æºäºå‡½æ•°å¼ç¼–ç¨‹(FP)ï¼Œçº¯å‡½æ•°æ˜¯æ²¡æœ‰å‰¯ä½œç”¨çš„ï¼Œä¹Ÿä¸ä¾èµ–å¤–ç•Œç¯å¢ƒæˆ–è€…æ”¹å˜å¤–ç•Œç¯å¢ƒã€‚çº¯å‡½æ•°çš„æ¦‚å¿µæ˜¯ï¼šæ¥å—ç›¸åŒçš„è¾“å…¥ï¼Œä»»ä½•æƒ…å†µä¸‹è¾“å‡ºéƒ½æ˜¯ä¸€æ ·çš„ã€‚
éçº¯å‡½æ•°å­˜åœ¨å‰¯ä½œç”¨ï¼Œå‰¯ä½œç”¨å°±æ˜¯ï¼šç›¸åŒçš„è¾“å…¥ï¼Œè¾“å‡ºä¸ä¸€å®šç›¸åŒã€‚æˆ–è€…è¿™ä¸ªå‡½æ•°ä¼šå½±å“åˆ°å¤–éƒ¨å˜é‡ã€å¤–éƒ¨ç¯å¢ƒã€‚
å‡½æ•°å¦‚æœè°ƒç”¨äº†å…¨å±€å¯¹è±¡æˆ–è€…æ”¹å˜å‡½æ•°å¤–éƒ¨å˜é‡ï¼Œåˆ™è¯´æ˜è¿™ä¸ªå‡½æ•°æœ‰å‰¯ä½œç”¨ã€‚</p> <h2 id="ä»£ç åˆ†å‰²ï¼šåŠ¨æ€importï¼Œæ‡’åŠ è½½è„šæœ¬"><a href="#ä»£ç åˆ†å‰²ï¼šåŠ¨æ€importï¼Œæ‡’åŠ è½½è„šæœ¬" class="header-anchor">#</a> ä»£ç åˆ†å‰²ï¼šåŠ¨æ€importï¼Œæ‡’åŠ è½½è„šæœ¬</h2> <p>æ”¯æŒåŠ¨æ€importéœ€è¦babelçš„æ’ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@babel/preset-react&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/plugin-syntax-dynamic-import&quot;</span> <span class="token comment">// å°±æ˜¯è¿™ä¸ª</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// åŠ¨æ€importï¼š</span>
<span class="token function">loadComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./text.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">Text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        Text<span class="token operator">:</span> Text<span class="token punctuation">.</span>default
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ‰“åŒ…çš„æ—¶å€™ï¼Œtext.jsè¿™ä¸ªç»„ä»¶ä¼šå•ç‹¬buildï¼Œå½¢å¦‚ï¼š1_43d42d49.jsï¼ˆæ‰“åŒ…å‡ºæ¥çš„æ‡’åŠ è½½è„šæœ¬ï¼‰ã€‚åªæœ‰æ‰§è¡ŒloadComponentçš„æ—¶å€™æ‰ä¼šåŠ è½½è¯¥æ–‡ä»¶ã€‚</p> <h2 id="webpackæ‰“åŒ…library"><a href="#webpackæ‰“åŒ…library" class="header-anchor">#</a> webpackæ‰“åŒ…library</h2> <p>è¿™é‡Œçš„ä¾‹å­æ˜¯ä¸€ä¸ªè®¡ç®—å¤§æ•´æ•°çš„addå‡½æ•°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> a<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token keyword">let</span> j <span class="token operator">=</span> b<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token keyword">let</span> carry <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">||</span> j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      x <span class="token operator">=</span> <span class="token operator">+</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      i<span class="token operator">--</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      y <span class="token operator">=</span> <span class="token operator">+</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
      j<span class="token operator">--</span>
    <span class="token punctuation">}</span> 
    <span class="token comment">// add('99999999999999999999999999999999999', '1')</span>
    sum <span class="token operator">=</span> x <span class="token operator">+</span> y <span class="token operator">+</span> carry
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      carry <span class="token operator">=</span> <span class="token number">1</span>
      sum <span class="token operator">-=</span> <span class="token number">10</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      carry <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    ret <span class="token operator">=</span> sum <span class="token operator">+</span> ret
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>carry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret <span class="token operator">=</span> carry <span class="token operator">+</span> ret
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ret
<span class="token punctuation">}</span>
webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>jsé…ç½®ï¼š
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span> <span class="token comment">// å‹ç¼©å™¨</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'large-number'</span><span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span> <span class="token comment">// å®Œæ•´ç‰ˆ</span>
    <span class="token string">'large-number.min'</span><span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span> <span class="token comment">// å‹ç¼©ç‰ˆ</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    library<span class="token operator">:</span> <span class="token string">'largeNumber'</span><span class="token punctuation">,</span>
    libraryTarget<span class="token operator">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
    libraryExport<span class="token operator">:</span> <span class="token string">'default'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mode<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span> <span class="token comment">// å¦‚æœè¿™é‡Œæ˜¯productionçš„è¯ï¼Œä¸Šé¢çš„ä¸¤ä¸ªæ–‡ä»¶éƒ½ä¼šè¢«å‹ç¼©ï¼Œæ‰€ä»¥éœ€è¦ä¸‹é¢æˆ‘ä»¬æ‰‹åŠ¨è®¾ç½®å‹ç¼©è§„åˆ™</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//å¼€å¯å‹ç¼©å·¥å…·ï¼Œmodeæ˜¯productionçš„æ—¶å€™ä¹Ÿæ˜¯true</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        include<span class="token operator">:</span> <span class="token regex">/\.min\.js$/</span>  <span class="token comment">// åªå‹ç¼©.min.jsç»“å°¾çš„æ–‡ä»¶</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å‘å¸ƒåˆ°npmï¼š"><a href="#å‘å¸ƒåˆ°npmï¼š" class="header-anchor">#</a> å‘å¸ƒåˆ°npmï¼š</h2> <p>package.jsoné…ç½®ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;large-number&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;add big number&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// index.jsè´Ÿè´£åˆ¤æ–­ç¯å¢ƒï¼Œå¯¼å‡ºæ‰“åŒ…å¥½çš„è„šæœ¬</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;prepublish&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;terser-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.3.5&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.41.6&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.3.11&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>index.jsï¼Œåˆ¤æ–­ç¯å¢ƒï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/large-number.min.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/large-number.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å‘å¸ƒåˆ°npmæµç¨‹ï¼š</p> <ul><li>npm loginï¼šç™»é™†npmè´¦å·ï¼›</li> <li>npm publishï¼šå‘å¸ƒåˆ°npmã€‚</li></ul> <h2 id="æœåŠ¡ç«¯æ¸²æŸ“ssr"><a href="#æœåŠ¡ç«¯æ¸²æŸ“ssr" class="header-anchor">#</a> æœåŠ¡ç«¯æ¸²æŸ“SSR</h2> <p>æ‰€æœ‰æ¨¡ç‰ˆç­‰èµ„æºéƒ½å­˜å‚¨åœ¨æœåŠ¡å™¨ï¼Œå†…ç½‘æœºå™¨æ‹‰å–æ•°æ®æ›´å¿«ï¼Œä¸€ä¸ªHTMLè¿”å›æ‰€æœ‰æ•°æ®ã€‚</p> <p>æœåŠ¡ç«¯æ¸²æŸ“çš„ä¼˜åŠ¿ï¼š</p> <ul><li>å‡å°‘ç™½å±æ—¶é—´</li> <li>å¯¹äºSEOå‹å¥½ï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“(SPA)ä¸€å¼€å§‹æŠŠhtmlæ‹‰ä¸‹æ¥ï¼Œä»€ä¹ˆå†…å®¹éƒ½æ²¡æœ‰ï¼Œä¸åˆ©äºçˆ¬è™«åˆ†æï¼‰</li></ul> <p>å…·ä½“å‚è€ƒ<a href="https://ssr.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">vueæœåŠ¡ç«¯æ¸²æŸ“æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>æœåŠ¡ç«¯æ¸²æŸ“ï¼Œä¸èƒ½ç”¨importï¼Œå…¨éƒ¨æ”¹æˆCJSè¯­æ³•ï¼Œç”¨requireã€‚æ³¨æ„æœåŠ¡ç«¯æ²¡æœ‰çš„å¯¹è±¡è¦åšç‰¹æ®Šå¤„ç†ï¼Œä¾‹å¦‚windowï¼Œdocumentç­‰ç­‰ã€‚å‘½åè§„èŒƒå¯ä»¥æ˜¯ï¼Œå½¢å¦‚ï¼šindex-server.jsã€‚æ¨¡ç‰ˆæ¸²æŸ“å…·ä½“å¯ä»¥å‚è€ƒvueå’Œreactçš„ssræ–‡æ¡£ã€‚</p> <p>æœåŠ¡ç«¯æ¸²æŸ“ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// hackå¤„ç†ï¼ŒæœåŠ¡ç«¯æ²¡æœ‰windowç­‰å¯¹è±¡</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  global<span class="token punctuation">.</span>window <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> renderToString <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-dom/server'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token constant">SSR</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../dist/search-server'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist/search.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">server</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">port</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/search'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">renderMarkup</span><span class="token punctuation">(</span><span class="token function">renderToString</span><span class="token punctuation">(</span><span class="token constant">SSR</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port:'</span> <span class="token operator">+</span> port<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">server</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span><span class="token punctuation">)</span>

<span class="token comment">// è§£å†³æ ·å¼ä¸æ˜¾ç¤ºçš„é—®é¢˜ï¼š</span>
<span class="token comment">// ä½¿â½¤ç”¨æ‰“åŒ…å‡ºæ¥çš„æµè§ˆå™¨ç«¯ html ä¸ºæ¨¡æ¿ </span>
<span class="token comment">// è®¾ç½®å ä½ç¬¦ï¼ŒåŠ¨æ€æ’â¼Šç»„ä»¶ </span>
<span class="token keyword">const</span> <span class="token function-variable function">renderMarkup</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dataStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token keyword">return</span> template<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;!-- HTML_PLACEHOLDER --&gt;'</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;!-- INITIAL_DATA-PLACEHOLDER --&gt;'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script&gt;widow.__initial_data=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dataStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/script&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>PSï¼šåœ¨index.htmlæŒ‰ç…§çº¦å®šç”¨å ä½ç¬¦ï¼Œå†æŠŠæ ¹å…ƒç´ rootæ›¿æ¢æˆreact renderToStringå‡ºæ¥çš„ç»„ä»¶å­—ç¬¦ä¸²ã€‚æ‰“åŒ…å‡ºæ¥çš„search.jsæ˜¯è¿™æ ·çš„ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width,initial-scale=1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>search_1fefdefd.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!-- HTML_PLACEHOLDER --&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!-- INITIAL_DATA-PLACEHOLDER --&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>search-server.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="ä¼˜åŒ–æ„å»ºæ—¶å‘½ä»¤è¡Œçš„æ˜¾ç¤ºæ—¥å¿—"><a href="#ä¼˜åŒ–æ„å»ºæ—¶å‘½ä»¤è¡Œçš„æ˜¾ç¤ºæ—¥å¿—" class="header-anchor">#</a> ä¼˜åŒ–æ„å»ºæ—¶å‘½ä»¤è¡Œçš„æ˜¾ç¤ºæ—¥å¿—</h2> <p>åªéœ€è®¾ç½®webpack config:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	entry<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	output<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	stats<span class="token operator">:</span> <span class="token string">'errors-only'</span>
	<span class="token comment">// å¦‚æœæ˜¯devç¯å¢ƒï¼š</span>
	devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    stats<span class="token operator">:</span> <span class="token string">'errors-only'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ•ˆæœè¿˜æ˜¯ä¸æ˜¯å¾ˆç†æƒ³ï¼Œä½¿ç”¨ä¼˜åŒ–æ’ä»¶<code>friendly-errors-webpack-plugin</code>ã€‚</p> <h2 id="æ„å»ºåŒ…å·¥ç¨‹åŒ–è®¾è®¡"><a href="#æ„å»ºåŒ…å·¥ç¨‹åŒ–è®¾è®¡" class="header-anchor">#</a> æ„å»ºåŒ…å·¥ç¨‹åŒ–è®¾è®¡</h2> <p>webpack base, dev, prodæœ‰äº›é…ç½®æ˜¯é€šç”¨çš„ï¼Œå†™åœ¨baseé‡Œé¢ï¼Œå…¶ä»–é…ç½®æ–‡ä»¶éœ€è¦ä½¿ç”¨webpack mergeæ¥åˆå¹¶baseé€‰é¡¹ï¼šhttps://www.npmjs.com/package/webpack-merge</p> <h2 id="eslint"><a href="#eslint" class="header-anchor">#</a> Eslint</h2> <p>å®‰è£…ï¼š</p> <p><code>npm i eslint babel-eslint eslint-config-airbnb-base eslint-plugin-import -D</code></p> <p>.eslintrc.jsé…ç½®ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel-eslint&quot;</span><span class="token punctuation">,</span> 
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;airbnb-base&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;browser&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">&quot;node&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;parserOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;ecmaVersion&quot;</span><span class="token operator">:</span> <span class="token number">6</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">package</span><span class="token punctuation">.</span>jsoné…ç½®ï¼š
<span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint ./lib --fix&quot;</span> <span class="token comment">// æ ¡éªŒlibæ–‡ä»¶å¤¹ï¼Œè‡ªåŠ¨ä¿®å¤ç©ºæ ¼æ ¼å¼</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å†’çƒŸæµ‹è¯•"><a href="#å†’çƒŸæµ‹è¯•" class="header-anchor">#</a> å†’çƒŸæµ‹è¯•</h2> <p>ä»¥æˆ‘ä»¬ç¬¬23ç‚¹åšçš„webpackæ„å»ºå·¥ç¨‹åŒ–åŒ…ä¸ºä¾‹ï¼Œæˆ‘ä»¬çš„å†’çƒŸæµ‹è¯•ä¸»è¦æµ‹è¯•ï¼š</p> <ul><li>æ„å»ºæ˜¯å¦æˆåŠŸï¼ˆwebpackæ„å»ºé”™è¯¯å›è°ƒï¼‰</li> <li>æ¯æ¬¡æ„å»ºå®Œæˆbuildç›®å½•æ˜¯å¦æœ‰å†…å®¹è¾“å‡ºï¼ˆæµ‹è¯•å·¥å…·æ£€æŸ¥ï¼šæ˜¯å¦æœ‰.html, .js, .cssç­‰æ–‡ä»¶ï¼‰</li></ul> <p>æ£€æŸ¥./distæ–‡ä»¶å¤¹é‡Œçš„ç”Ÿæˆç‰©ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// css-js-test.js:</span>
<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob-all'</span><span class="token punctuation">)</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Checking generated css&amp;js files'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should generate css&amp;js files'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token string">'./dist/index_*.js'</span><span class="token punctuation">,</span>
      <span class="token string">'./dist/index_*.css'</span><span class="token punctuation">,</span>
      <span class="token string">'./dist/search_*.js'</span><span class="token punctuation">,</span>
      <span class="token string">'./dist/search_*.css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>files<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'no css&amp;js files generated'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// index.js:</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rimraf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'rimraf'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Mocha <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mocha'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> mocha <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mocha</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  timeout<span class="token operator">:</span> <span class="token string">'10000ms'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

process<span class="token punctuation">.</span><span class="token function">chdir</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'template'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// è¿›å…¥åˆ°å½“å‰å†’çƒŸæµ‹è¯•çš„templateç›®å½•</span>

<span class="token comment">// ç§»é™¤distç›®å½•</span>
<span class="token function">rimraf</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../lib/webpack.prod.js'</span><span class="token punctuation">)</span>

  <span class="token comment">// åˆ é™¤distç›®å½•ä¹‹åè¿è¡Œæ„å»º</span>
  <span class="token function">webpack</span><span class="token punctuation">(</span>prodConfig<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ„å»ºæ˜¯å¦æˆåŠŸ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// ä»¥é”™è¯¯ç 2é€€å‡º</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      colors<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      modules<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      children<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Webpack build success, begin run test.'</span><span class="token punctuation">)</span>

    <span class="token comment">// mochaï¼šæ£€æŸ¥æ˜¯å¦æœ‰äº§ç‰©</span>
    mocha<span class="token punctuation">.</span><span class="token function">addFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'css-js-test.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    mocha<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="å•å…ƒæµ‹è¯•-æµ‹è¯•è¦†ç›–ç‡"><a href="#å•å…ƒæµ‹è¯•-æµ‹è¯•è¦†ç›–ç‡" class="header-anchor">#</a> å•å…ƒæµ‹è¯•&amp;æµ‹è¯•è¦†ç›–ç‡</h2> <p>Mocha+chai/assertã€Jestï¼ˆreactï¼‰</p> <p>æµ‹è¯•è¦†ç›–ç‡ï¼šnpm nyc -D</p> <h2 id="æŒç»­é›†æˆci"><a href="#æŒç»­é›†æˆci" class="header-anchor">#</a> æŒç»­é›†æˆCI</h2> <ul><li>https://travis-ci.org/ ä½¿ç”¨ GitHub è´¦å·ç™»å½•</li> <li>åœ¨ https://travis-ci.org/account/repositories ä¸ºé¡¹ç›®å¼€å¯</li> <li>é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å¢ .travis.yml</li></ul> <h2 id="å‘å¸ƒåˆ°npm"><a href="#å‘å¸ƒåˆ°npm" class="header-anchor">#</a> å‘å¸ƒåˆ°npm</h2> <p>å‡çº§ç‰ˆæœ¬ï¼Œæ‰§è¡Œå‘½ä»¤ä¼šè‡ªåŠ¨æ”¹å˜ä¸‰ä½çš„ç‰ˆæœ¬æ•°å­—ï¼ˆeg: v1.0.0ï¼‰</p> <ul><li>å‡çº§è¡¥ä¸ç‰ˆæœ¬å·: npm version patch (è‡ªåŠ¨å˜æˆv1.0.1)</li> <li>å‡çº§å°ç‰ˆæœ¬å·: npm version minor (v1.1.0)</li> <li>å‡çº§å¤§ç‰ˆæœ¬å·: npm version major (v2.0.0)</li></ul> <p>å‘å¸ƒç‰ˆæœ¬: npm publish</p> <h2 id="commitè§„èŒƒ-changlogç”Ÿæˆ"><a href="#commitè§„èŒƒ-changlogç”Ÿæˆ" class="header-anchor">#</a> Commitè§„èŒƒ&amp;Changlogç”Ÿæˆ</h2> <p>å‚è€ƒangularçš„ commitè§„èŒƒã€‚
ï¿¼
subjectï¼šå¯¹æäº¤å†…å®¹çš„æ€»ç»“æè¿°
bodyï¼šå¦‚æœä¸€å¥è¯æ€»ç»“ä¸äº†ï¼Œå°±åœ¨bodyé‡Œæ¢è¡Œåˆ—å‡ºå¯¹æäº¤çš„ä»£ç çš„æè¿°
footerï¼šå¯ä»¥è´´ä¸€äº›é“¾æ¥ï¼Œæ¯”å¦‚ä¿®å¤issueçš„é“¾æ¥</p> <p>æœ¬åœ°å¼€å‘é˜¶æ®µå¢åŠ  precommit é’©å­&amp;è‡ªåŠ¨ç”Ÿæˆchangelogï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install husky <span class="token operator">-</span><span class="token constant">D</span>
<span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>	<span class="token string">&quot;commitmsg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;validate-commit-msg&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;changelog&quot;</span><span class="token operator">:</span> <span class="token string">&quot;conventional-changelog -p angular -i CHANGELOG.md -s -r 0&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token string">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token string">&quot;validate-commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.11.1&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;conventional-changelog-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.2.0&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.13.1&quot;</span> 
<span class="token punctuation">}</span>
</code></pre></div><h2 id="webpackæ„å»ºé€Ÿåº¦ç»Ÿè®¡ï¼šå†…ç½®çš„stats"><a href="#webpackæ„å»ºé€Ÿåº¦ç»Ÿè®¡ï¼šå†…ç½®çš„stats" class="header-anchor">#</a> webpackæ„å»ºé€Ÿåº¦ç»Ÿè®¡ï¼šå†…ç½®çš„stats</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;build:stats&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config webpack.prod.js --json &gt; stats.json&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="é€Ÿåº¦åˆ†æï¼šspeed-measure-webpack-plugin"><a href="#é€Ÿåº¦åˆ†æï¼šspeed-measure-webpack-plugin" class="header-anchor">#</a> é€Ÿåº¦åˆ†æï¼šspeed-measure-webpack-plugin</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasureWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	entry<span class="token operator">:</span> <span class="token comment">//,</span>
	output<span class="token operator">:</span> <span class="token comment">//,</span>
	plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ï¿¼</p> <h2 id="ä½“ç§¯åˆ†æï¼šwebpack-bundle-analyzer"><a href="#ä½“ç§¯åˆ†æï¼šwebpack-bundle-analyzer" class="header-anchor">#</a> ä½“ç§¯åˆ†æï¼šwebpack-bundle-analyzer</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span><span class="token function"> require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span>
 
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// ä¼šè‡ªåŠ¨æ‰“å¼€http://127.0.0.1:8888/</span>
</code></pre></div><p>å¤‡æ³¨ï¼šå‡ ä¸ªsizeçš„æ„ä¹‰ï¼Ÿ
ï¿¼
statsæ˜¯webpackç»Ÿè®¡çš„å‹ç¼©å·¥å…·ä¹‹å‰çš„å¤§å°ï¼Œparsedæ˜¯ç»è¿‡å‹ç¼©ä¹‹åçš„å¤§å°ã€‚</p> <h2 id="å¤šè¿›ç¨‹-å¤šå®ä¾‹æ„å»º"><a href="#å¤šè¿›ç¨‹-å¤šå®ä¾‹æ„å»º" class="header-anchor">#</a> å¤šè¿›ç¨‹/å¤šå®ä¾‹æ„å»º</h2> <p>thread-loader</p> <h2 id="å¹¶è¡Œå‹ç¼©"><a href="#å¹¶è¡Œå‹ç¼©" class="header-anchor">#</a> å¹¶è¡Œå‹ç¼©</h2> <p>terser-webpack-plugin</p> <h2 id="é¢„ç¼–è¯‘èµ„æºæ¨¡å—"><a href="#é¢„ç¼–è¯‘èµ„æºæ¨¡å—" class="header-anchor">#</a> é¢„ç¼–è¯‘èµ„æºæ¨¡å—</h2> <p>æ€è·¯:å°† reactã€react-domã€reduxã€react-redux åŸºç¡€åŒ…å’Œä¸šåŠ¡åŸºç¡€åŒ…æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶</p> <p>æ–¹æ³•:ä½¿ç”¨ DLLPlugin è¿›è¡Œåˆ†åŒ…ï¼ŒDllReferencePlugin å¯¹ manifest.json å¼•ç”¨</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.dll.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    library<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">'react'</span><span class="token punctuation">,</span>
      <span class="token string">'react-dom'</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'[name]_[chunkhash].dll.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'build/library'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    library<span class="token operator">:</span> <span class="token string">'[name]'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'[name]_[hash]'</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'build/library/[name].json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// webpack.prod.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./build/library/library.json'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="ç¼“å­˜æé«˜äºŒæ¬¡æ„å»ºé€Ÿåº¦"><a href="#ç¼“å­˜æé«˜äºŒæ¬¡æ„å»ºé€Ÿåº¦" class="header-anchor">#</a> ç¼“å­˜æé«˜äºŒæ¬¡æ„å»ºé€Ÿåº¦</h2> <ul><li>babel-loader å¼€å¯ç¼“å­˜</li> <li>terser-webpack-plugin å¼€å¯ç¼“å­˜</li> <li>ä½¿ç”¨ cache-loader æˆ–è€… hard-source-webpack-plugin</li></ul> <h2 id="å‡å°‘æ–‡ä»¶æœç´¢èŒƒå›´"><a href="#å‡å°‘æ–‡ä»¶æœç´¢èŒƒå›´" class="header-anchor">#</a> å‡å°‘æ–‡ä»¶æœç´¢èŒƒå›´</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä¼˜åŒ–ï¼šä¼˜åŒ–æ„å»ºè·¯å¾„æŸ¥æ‰¾è¿‡ç¨‹</span>
resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
  alias<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'react'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./node_modules/react/umd/react.production.min.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'react-dom'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./node_modules/react-dom/umd/react-dom.production.min.js'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  mainFields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'main'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ä½“ç§¯ä¼˜åŒ–ï¼šåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„css"><a href="#ä½“ç§¯ä¼˜åŒ–ï¼šåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„css" class="header-anchor">#</a> ä½“ç§¯ä¼˜åŒ–ï¼šåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„CSS</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> PurgecssPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'purgecss-webpack-plugin'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token constant">PATHS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  src<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">PurgecssPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      paths<span class="token operator">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PATHS</span><span class="token punctuation">.</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> nodir<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="åŠ¨æ€polyfill"><a href="#åŠ¨æ€polyfill" class="header-anchor">#</a> åŠ¨æ€polyfill</h2> <p><a href="https://polyfill.io/v3/polyfill.min.js" target="_blank" rel="noopener noreferrer">https://polyfill.io/v3/polyfill.min.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="webpackåŸç†è§£æ"><a href="#webpackåŸç†è§£æ" class="header-anchor">#</a> webpackåŸç†è§£æ</h2> <h3 id="npm-run-dev-buildå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#npm-run-dev-buildå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="header-anchor">#</a> npm run dev/buildå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3> <p>åœ¨å‘½ä»¤è¡Œè¿è¡Œä»¥ä¸Šå‘½ä»¤åï¼Œnpmä¼šè®©å‘½ä»¤è¡Œå·¥å…·è¿›å…¥<code>node_modules\.bin</code> ç›®å½•ï¼ŒæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ webpack.shï¼ˆmacå‘½ä»¤ï¼‰æˆ–è€… webpack.cmdï¼ˆwindowså‘½ä»¤ï¼‰æ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±æ‰§è¡Œï¼Œä¸å­˜åœ¨ï¼Œå°±æŠ›å‡ºé”™è¯¯ã€‚
å®é™…çš„å…¥å£æ–‡ä»¶æ˜¯: <code>node_modules\webpack\bin\webpack.js</code> ï¼ˆè¿™é‡Œä¼šç”Ÿæˆä¸Šé¢çš„é‚£ä¸ªå‘½ä»¤ï¼‰</p> <p>å¯åŠ¨åçš„ç»“æœï¼š
webpack.jsæœ€ç»ˆæ‰¾åˆ°webpack-cli(æˆ–webpack-command)è¿™ä¸ªnpmåŒ…ï¼Œå¹¶ä¸”æ‰§è¡ŒCLI ã€‚</p> <h3 id="webpack-cli"><a href="#webpack-cli" class="header-anchor">#</a> webpack-cli</h3> <p>webpack-cli åšçš„äº‹æƒ…</p> <ul><li>å¼•å…¥ yargsï¼Œå¯¹å‘½ä»¤è¡Œè¿›è¡Œå®šåˆ¶ åˆ†æå‘½ä»¤è¡Œå‚æ•°ã€‚</li> <li>å¯¹å„ä¸ªå‚æ•°è¿›è¡Œè½¬æ¢ï¼Œç»„æˆç¼–è¯‘é…ç½®é¡¹ å¼•ç”¨webpackã€‚</li> <li>æ ¹æ®é…ç½®é¡¹è¿›è¡Œç¼–è¯‘å’Œæ„å»º</li></ul> <p>webpack-cli æä¾›çš„ä¸éœ€è¦ç¼–è¯‘çš„å‘½ä»¤ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">NON_COMPILATION_ARGS</span> <span class="token operator">=</span> <span class="token punctuation">[</span> 
	<span class="token string">&quot;init&quot;</span><span class="token punctuation">,</span> 			<span class="token comment">// åˆ›å»ºä¸€ä»½ webpack é…ç½®æ–‡ä»¶</span>
	<span class="token string">&quot;migrate&quot;</span><span class="token punctuation">,</span>		<span class="token comment">// è¿›è¡Œ webpack ç‰ˆæœ¬è¿ç§»</span>
	<span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span>		      <span class="token comment">// å¾€ webpack é…ç½®æ–‡ä»¶ä¸­å¢åŠ å±æ€§</span>
	<span class="token string">&quot;remove&quot;</span><span class="token punctuation">,</span> 	      <span class="token comment">// å¾€ webpack é…ç½®æ–‡ä»¶ä¸­åˆ é™¤å±æ€§</span>
	<span class="token string">&quot;serve&quot;</span><span class="token punctuation">,</span>	      <span class="token comment">// è¿è¡Œ webpack-serve	&quot;generate-loader&quot;, 	// ç”Ÿæˆ webpack loader ä»£ç </span>
 	<span class="token string">&quot;generate-plugin&quot;</span><span class="token punctuation">,</span>    <span class="token comment">// ç”Ÿæˆ webpack plugin ä»£ç  </span>
	<span class="token string">&quot;info&quot;</span>			<span class="token comment">// è¿”å›ä¸æœ¬åœ°ç¯å¢ƒç›¸å…³çš„ä¸€äº›ä¿¡æ¯ </span>
<span class="token punctuation">]</span>
</code></pre></div><p>webpacké€šè¿‡å‘½ä»¤è¡Œå·¥å…·åŒ…yargsè¯»å–å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œå‚æ•°åˆ†ç»„ (config/config-args.js)ï¼Œå°†å‘½ä»¤åˆ’åˆ†ä¸º9ç±»:</p> <ul><li>Config options: é…ç½®ç›¸å…³å‚æ•°(æ–‡ä»¶åç§°ã€è¿è¡Œç¯å¢ƒç­‰)</li> <li>Basic options: åŸºç¡€å‚æ•°(entryè®¾ç½®ã€debugæ¨¡å¼è®¾ç½®ã€watchç›‘å¬è®¾ç½®ã€devtoolè®¾ç½®)</li> <li>Module options: æ¨¡å—å‚æ•°ï¼Œç»™ loader è®¾ç½®æ‰©å±•</li> <li>Output options: è¾“å‡ºå‚æ•°(è¾“å‡ºè·¯å¾„ã€è¾“å‡ºæ–‡ä»¶åç§°)</li> <li>Advanced options: é«˜çº§ç”¨æ³•(è®°å½•è®¾ç½®ã€ç¼“å­˜è®¾ç½®ã€ç›‘å¬é¢‘ç‡ã€bailç­‰)</li> <li>Resolving options: è§£æå‚æ•°(alias å’Œ è§£æçš„æ–‡ä»¶åç¼€è®¾ç½®)</li> <li>Optimizing options: ä¼˜åŒ–å‚æ•°</li> <li>Stats options: ç»Ÿè®¡å‚æ•°</li> <li>options: é€šç”¨å‚æ•°(å¸®åŠ©å‘½ä»¤ã€ç‰ˆæœ¬ä¿¡æ¯ç­‰)</li></ul> <p>webpack-cli æ‰§è¡Œçš„ç»“æœï¼š</p> <p>webpack-cliå¯¹é…ç½®æ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°è¿›è¡Œè½¬æ¢æœ€ç»ˆç”Ÿæˆé…ç½®é€‰é¡¹å‚æ•° options
æœ€ç»ˆä¼šæ ¹æ®é…ç½®å‚æ•°å®ä¾‹åŒ– webpack å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œæ„å»ºæµç¨‹</p> <h2 id="webpackçš„æ ¸å¿ƒï¼štapable"><a href="#webpackçš„æ ¸å¿ƒï¼štapable" class="header-anchor">#</a> webpackçš„æ ¸å¿ƒï¼štapable</h2> <p>Webpack çš„æœ¬è´¨ï¼šWebpackå¯ä»¥å°†å…¶ç†è§£æ˜¯ä¸€ç§åŸºäºäº‹ä»¶æµçš„ç¼–ç¨‹èŒƒä¾‹ï¼Œä¸€ç³»åˆ—çš„æ’ä»¶è¿è¡Œã€‚</p> <p>æ ¸å¿ƒå¯¹è±¡ Compiler ç»§æ‰¿ Tapable</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Compiler</span> <span class="token keyword">extends</span> <span class="token class-name">Tapable</span> <span class="token punctuation">{</span> 
	<span class="token comment">// ... </span>
<span class="token punctuation">}</span> 
</code></pre></div><p>æ ¸å¿ƒå¯¹è±¡ Compilation ç»§æ‰¿ Tapable</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Compilation</span> <span class="token keyword">extends</span> <span class="token class-name">Tapable</span> <span class="token punctuation">{</span> 
	<span class="token comment">// ... </span>
<span class="token punctuation">}</span> 
</code></pre></div><p>Tapable æ˜¯ä¸€ä¸ªç±»ä¼¼äº Node.js çš„ EventEmitter çš„åº“ï¼Œä¸»è¦æ˜¯æ§åˆ¶é’©å­å‡½æ•°çš„å‘å¸ƒä¸è®¢é˜…,æ§åˆ¶ç€ webpack çš„æ’ä»¶ç³»ç»Ÿã€‚</p> <p>Tapableåº“æš´éœ²äº†å¾ˆå¤š Hook(é’©å­)ç±»ï¼Œä¸ºæ’ä»¶æä¾›æŒ‚è½½çš„é’©å­ã€‚</p> <p>compilerå¯¹è±¡é‡Œæœ‰ä¸€ç™¾å¤šä¸ªhooksï¼Œç„¶åwepack.jsä¼šæŠŠcompilerå¯¹è±¡ä¼ ç»™æ¯ä¸€ä¸ªpluginï¼Œpluginå¿…é¡»å®ç°applyæ–¹æ³•ï¼Œwebpackä¼šæŠŠcompilerå¯¹è±¡ä¼ é€’ç»™pluginï¼Œé€šå¸¸åœ¨pluginå†…éƒ¨ä¼šç”¨hooks.tapçš„æ–¹å¼ç›‘å¬compileré‡Œé¢çš„é’©å­ï¼Œä»è€Œåœ¨é€‚å½“çš„æ—¶æœºæ‰§è¡Œpluginé‡Œé¢çš„ä»£ç ã€‚</p> <p>tapableå¦‚ä½•å’Œwebpackè”ç³»èµ·æ¥ï¼Ÿ</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// node_modules/webpack/lib/webpack.js</span>
<span class="token keyword">let</span> compiler<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  compiler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MultiCompiler</span><span class="token punctuation">(</span>
    Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">options</span> <span class="token operator">=&gt;</span> <span class="token function">webpack</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> options <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebpackOptionsDefaulter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

  compiler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Compiler</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  compiler<span class="token punctuation">.</span>options <span class="token operator">=</span> options<span class="token punctuation">;</span>
  <span class="token keyword">new</span> <span class="token class-name">NodeEnvironmentPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    infrastructureLogging<span class="token operator">:</span> options<span class="token punctuation">.</span>infrastructureLogging
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// éå†optionsé€‰é¡¹ä¸­çš„æ’ä»¶ï¼Œä¼ å…¥compilerå¯¹è±¡</span>
  <span class="token comment">// è¿™äº›æ’ä»¶ä¼šç›‘å¬compilerä¸­çš„hooksï¼Œä»è€Œåœ¨æŸä¸ªæ—¶æœºæ‰§è¡Œã€‚</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>plugins <span class="token operator">&amp;&amp;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>plugins<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> plugin <span class="token keyword">of</span> options<span class="token punctuation">.</span>plugins<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> plugin <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">plugin</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">plugin</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">environment</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">afterEnvironment</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  compiler<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebpackOptionsApply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid argument: options&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>43.webpackçš„æ„å»ºæµç¨‹-æ¨¡å—æ„å»ºå’Œchunkç”Ÿæˆé˜¶æ®µ</p> <p>çœ‹æºä»£ç æµç¨‹ï¼š</p> <p>make=&gt; addEntry =&gt; _addModuleChain =&gt; buildModule =&gt; module.build(parser) =&gt; seal =&gt; optimization =&gt; createHash =&gt; createModuleAssets(seal done) =&gt; emit
compile.jsé‡Œé¢run()è§¦å‘makeé’©å­ï¼ŒSingleEntryPlugin.jsç­‰æ’ä»¶ç›‘å¬äº†makeé’©å­ï¼Œç„¶åå¼€å§‹æ ¹æ®entryå¯¹æ¨¡å—è¿›è¡Œåˆ†æï¼Œæ‰§è¡Œcompilationä¸­çš„addEntry()ï¼Œç„¶åæ‰§è¡ŒbuildModule()ï¼ŒbuildModuleä¼šè°ƒç”¨è¯¥æ¨¡å—ç±»å‹å¯¹åº”çš„buildæ–¹æ³•(module.build())ï¼Œç„¶åå®é™…è°ƒç”¨ä¾‹å¦‚NormalModule.jsé‡Œé¢çš„doBuild()ã€‚åœ¨è¿™é‡Œå¯¹æ¨¡å—çš„ç›¸å…³require()è¿›è¡Œè§£æï¼Œæœ€åæŠŠbuildå‡ºæ¥çš„ä»£ç æ”¾åˆ°compilationçš„moduleså¯¹è±¡é‡Œã€‚ç„¶åè§¦å‘sealé’©å­ï¼Œè¿™é‡Œä¸»è¦è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œoptimizationã€‚</p> <p>Chunk ç”Ÿæˆç®—æ³• ï¼š</p> <ul><li>webpack å…ˆå°† entry ä¸­å¯¹åº”çš„ module éƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„ chunk</li> <li>éå† module çš„ä¾èµ–åˆ—è¡¨ï¼Œå°†ä¾èµ–çš„ module ä¹ŸåŠ å…¥åˆ° chunk ä¸­</li> <li>å¦‚æœä¸€ä¸ªä¾èµ– module æ˜¯åŠ¨æ€å¼•å…¥çš„æ¨¡å—ï¼Œé‚£ä¹ˆå°±ä¼šæ ¹æ®è¿™ä¸ª module åˆ›å»ºä¸€ä¸ª æ–°çš„ chunkï¼Œç»§ç»­éå†ä¾èµ–</li> <li>é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œç›´è‡³å¾—åˆ°æ‰€æœ‰çš„ chunks</li></ul> <h2 id="webpackçš„æ„å»ºæµç¨‹-æ–‡ä»¶ç”Ÿæˆ"><a href="#webpackçš„æ„å»ºæµç¨‹-æ–‡ä»¶ç”Ÿæˆ" class="header-anchor">#</a> webpackçš„æ„å»ºæµç¨‹-æ–‡ä»¶ç”Ÿæˆ</h2> <p>emité’©å­ï¼Œcompliation.assetsè¾“å‡ºåˆ°ç£ç›˜ç›®å½•.</p> <h2 id="loaderï¼ˆå¼€å‘loaderå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰"><a href="#loaderï¼ˆå¼€å‘loaderå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰" class="header-anchor">#</a> loaderï¼ˆå¼€å‘loaderå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰</h2> <p>loaderçš„æ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ã€‚ï¼ˆcomposeå‡½æ•°ï¼Œå‡½æ•°å¼ï¼‰</p> <p>loader-runnerï¼šloader-runner å…è®¸ä½ åœ¨ä¸å®‰è£… webpack çš„æƒ… å†µä¸‹è¿è¡Œ loadersã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä»£ç ç¤ºä¾‹</span>
<span class="token comment">// node run-loader.js</span>
<span class="token comment">// run-loader.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> runLoaders <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loader-runner'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token function">runLoaders</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resource<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/demo.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      loader<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/raw-loader.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token comment">// loaderçš„å‚æ•°ï¼Œå¯ä»¥é€šè¿‡loader-utilçš„getOptionsæ–¹æ³•æ¥è·å–æ­¤å‚æ•°</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'test'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  context<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimize<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  readResource<span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  err <span class="token operator">?</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">:</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// raw-loader.js</span>
<span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loader-utils'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–ä¼ é€’ç»™loaderçš„å‚æ•°</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'name:'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>

  <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/u2028/g</span><span class="token punctuation">,</span> <span class="token string">'\\u2028'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/u2029/g</span><span class="token punctuation">,</span> <span class="token string">'\\u2029'</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">export default </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>json<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token comment">// å¼‚æ­¥loaderï¼š</span>
<span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./async.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>loaderè¾“å‡ºå†…å®¹åˆ°æ–‡ä»¶ï¼šthis.emitFile(url, source)</p> <h2 id="å¼€å‘pluginï¼ˆå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰"><a href="#å¼€å‘pluginï¼ˆå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰" class="header-anchor">#</a> å¼€å‘pluginï¼ˆå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰</h2> <p>ä¼ å‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'aaa'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
<span class="token comment">// my-plugin.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å‚æ•°</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options
  <span class="token punctuation">}</span>

  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'My plugin is excuted!'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'My plugin options'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#init-package-json" title="init package.json">init package.json</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#scripts" title="scripts">scripts</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#plugins" title="Plugins">Plugins</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#mode" title="Mode">Mode</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#loader" title="Loader">Loader</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#file-loader" title="file-loader">file-loader</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#æ–‡ä»¶ç›‘å¬" title="æ–‡ä»¶ç›‘å¬">æ–‡ä»¶ç›‘å¬</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#watchçš„ç¼ºç‚¹" title="watchçš„ç¼ºç‚¹:">watchçš„ç¼ºç‚¹:</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#çƒ­æ›´æ–°-webpack-dev-server-hmr" title="çƒ­æ›´æ–°(webpack-dev-server) HMR">çƒ­æ›´æ–°(webpack-dev-server) HMR</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#çƒ­æ›´æ–°åŸç†ï¼š" title="çƒ­æ›´æ–°åŸç†ï¼š">çƒ­æ›´æ–°åŸç†ï¼š</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#æ–‡ä»¶æŒ‡çº¹" title="æ–‡ä»¶æŒ‡çº¹">æ–‡ä»¶æŒ‡çº¹</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ä»£ç å‹ç¼©" title="ä»£ç å‹ç¼©">ä»£ç å‹ç¼©</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#è‡ªåŠ¨æ¸…ç†æ„å»ºç›®å½•" title="è‡ªåŠ¨æ¸…ç†æ„å»ºç›®å½•">è‡ªåŠ¨æ¸…ç†æ„å»ºç›®å½•</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#postcss-loader" title="postcss-loader">postcss-loader</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ç§»åŠ¨ç«¯remæ‰“åŒ…é—®é¢˜" title="ç§»åŠ¨ç«¯remæ‰“åŒ…é—®é¢˜">ç§»åŠ¨ç«¯remæ‰“åŒ…é—®é¢˜</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#èµ„æºå†…è”" title="èµ„æºå†…è”">èµ„æºå†…è”</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#source-map" title="source-map">source-map</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#splitchunks" title="splitchunks">splitchunks</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#tree-shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰" title="tree shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰">tree shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ä»£ç åˆ†å‰²ï¼šåŠ¨æ€importï¼Œæ‡’åŠ è½½è„šæœ¬" title="ä»£ç åˆ†å‰²ï¼šåŠ¨æ€importï¼Œæ‡’åŠ è½½è„šæœ¬">ä»£ç åˆ†å‰²ï¼šåŠ¨æ€importï¼Œæ‡’åŠ è½½è„šæœ¬</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#webpackæ‰“åŒ…library" title="webpackæ‰“åŒ…library">webpackæ‰“åŒ…library</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å‘å¸ƒåˆ°npmï¼š" title="å‘å¸ƒåˆ°npmï¼š">å‘å¸ƒåˆ°npmï¼š</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#æœåŠ¡ç«¯æ¸²æŸ“ssr" title="æœåŠ¡ç«¯æ¸²æŸ“SSR">æœåŠ¡ç«¯æ¸²æŸ“SSR</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ä¼˜åŒ–æ„å»ºæ—¶å‘½ä»¤è¡Œçš„æ˜¾ç¤ºæ—¥å¿—" title="ä¼˜åŒ–æ„å»ºæ—¶å‘½ä»¤è¡Œçš„æ˜¾ç¤ºæ—¥å¿—">ä¼˜åŒ–æ„å»ºæ—¶å‘½ä»¤è¡Œçš„æ˜¾ç¤ºæ—¥å¿—</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#æ„å»ºåŒ…å·¥ç¨‹åŒ–è®¾è®¡" title="æ„å»ºåŒ…å·¥ç¨‹åŒ–è®¾è®¡">æ„å»ºåŒ…å·¥ç¨‹åŒ–è®¾è®¡</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#eslint" title="Eslint">Eslint</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å†’çƒŸæµ‹è¯•" title="å†’çƒŸæµ‹è¯•">å†’çƒŸæµ‹è¯•</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å•å…ƒæµ‹è¯•-æµ‹è¯•è¦†ç›–ç‡" title="å•å…ƒæµ‹è¯•&amp;æµ‹è¯•è¦†ç›–ç‡">å•å…ƒæµ‹è¯•&amp;æµ‹è¯•è¦†ç›–ç‡</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#æŒç»­é›†æˆci" title="æŒç»­é›†æˆCI">æŒç»­é›†æˆCI</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å‘å¸ƒåˆ°npm" title="å‘å¸ƒåˆ°npm">å‘å¸ƒåˆ°npm</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#commitè§„èŒƒ-changlogç”Ÿæˆ" title="Commitè§„èŒƒ&amp;Changlogç”Ÿæˆ">Commitè§„èŒƒ&amp;Changlogç”Ÿæˆ</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#webpackæ„å»ºé€Ÿåº¦ç»Ÿè®¡ï¼šå†…ç½®çš„stats" title="webpackæ„å»ºé€Ÿåº¦ç»Ÿè®¡ï¼šå†…ç½®çš„stats">webpackæ„å»ºé€Ÿåº¦ç»Ÿè®¡ï¼šå†…ç½®çš„stats</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#é€Ÿåº¦åˆ†æï¼šspeed-measure-webpack-plugin" title="é€Ÿåº¦åˆ†æï¼šspeed-measure-webpack-plugin">é€Ÿåº¦åˆ†æï¼šspeed-measure-webpack-plugin</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ä½“ç§¯åˆ†æï¼šwebpack-bundle-analyzer" title="ä½“ç§¯åˆ†æï¼šwebpack-bundle-analyzer">ä½“ç§¯åˆ†æï¼šwebpack-bundle-analyzer</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å¤šè¿›ç¨‹-å¤šå®ä¾‹æ„å»º" title="å¤šè¿›ç¨‹/å¤šå®ä¾‹æ„å»º">å¤šè¿›ç¨‹/å¤šå®ä¾‹æ„å»º</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å¹¶è¡Œå‹ç¼©" title="å¹¶è¡Œå‹ç¼©">å¹¶è¡Œå‹ç¼©</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#é¢„ç¼–è¯‘èµ„æºæ¨¡å—" title="é¢„ç¼–è¯‘èµ„æºæ¨¡å—">é¢„ç¼–è¯‘èµ„æºæ¨¡å—</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ç¼“å­˜æé«˜äºŒæ¬¡æ„å»ºé€Ÿåº¦" title="ç¼“å­˜æé«˜äºŒæ¬¡æ„å»ºé€Ÿåº¦">ç¼“å­˜æé«˜äºŒæ¬¡æ„å»ºé€Ÿåº¦</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å‡å°‘æ–‡ä»¶æœç´¢èŒƒå›´" title="å‡å°‘æ–‡ä»¶æœç´¢èŒƒå›´">å‡å°‘æ–‡ä»¶æœç´¢èŒƒå›´</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ä½“ç§¯ä¼˜åŒ–ï¼šåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„css" title="ä½“ç§¯ä¼˜åŒ–ï¼šåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„CSS">ä½“ç§¯ä¼˜åŒ–ï¼šåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„CSS</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#åŠ¨æ€polyfill" title="åŠ¨æ€polyfill">åŠ¨æ€polyfill</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#webpackåŸç†è§£æ" title="webpackåŸç†è§£æ">webpackåŸç†è§£æ</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#npm-run-dev-buildå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" title="npm run dev/buildå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ">npm run dev/buildå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#webpack-cli" title="webpack-cli">webpack-cli</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#webpackçš„æ ¸å¿ƒï¼štapable" title="webpackçš„æ ¸å¿ƒï¼štapable">webpackçš„æ ¸å¿ƒï¼štapable</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#webpackçš„æ„å»ºæµç¨‹-æ–‡ä»¶ç”Ÿæˆ" title="webpackçš„æ„å»ºæµç¨‹-æ–‡ä»¶ç”Ÿæˆ">webpackçš„æ„å»ºæµç¨‹-æ–‡ä»¶ç”Ÿæˆ</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#loaderï¼ˆå¼€å‘loaderå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰" title="loaderï¼ˆå¼€å‘loaderå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰">loaderï¼ˆå¼€å‘loaderå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å¼€å‘pluginï¼ˆå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰" title="å¼€å‘pluginï¼ˆå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰">å¼€å‘pluginï¼ˆå®˜ç½‘æœ‰æ•™ç¨‹ï¼‰</a></div></div></div></div> <footer class="footer" data-v-fdbf4940><div class="footer-left-wrap" data-v-fdbf4940><ul class="contact" data-v-fdbf4940><li class="contact-item" data-v-fdbf4940><a href="mailto: ischenkan@outlook.com" class="nav-link external" data-v-fdbf4940><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-fdbf4940><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-fdbf4940></path><polyline points="22,6 12,13 2,6" data-v-fdbf4940></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-fdbf4940><ul class="copyright" data-v-fdbf4940><li class="copyright-item" data-v-fdbf4940><a href="https://kuifafa.com" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-fdbf4940>Create by ğŸ±ç¤¾é•¿çš„ç¤¾ç•œ</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7f4b4882.js" defer></script><script src="/assets/js/8.4ab95c53.js" defer></script><script src="/assets/js/3.fadb76cf.js" defer></script><script src="/assets/js/36.66106bb5.js" defer></script>
  </body>
</html>
